{"ast":null,"code":"import { GraphQLClient } from \"graphql-request\";\n\n// ===============================\n// CONFIGURACIÓN DEL ENDPOINT\n// ===============================\n\n// URL desde tu archivo .env\n// EJEMPLO EN .env:\n// REACT_APP_API_URL=https://3c004bf2d4d8.ngrok-free.app/graphql\n\nconst endpoint = process.env.REACT_APP_API_URL;\nif (!endpoint) {\n  console.error(\"❌ ERROR: REACT_APP_API_URL no está definido en el archivo .env\");\n  throw new Error(\"REACT_APP_API_URL no configurado\");\n}\n\n// ===============================\n// CREACIÓN DEL CLIENTE BASE\n// ===============================\n\nfunction createClient(url) {\n  return new GraphQLClient(url, {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n}\nconst baseClient = createClient(endpoint);\n\n// ===============================\n// EXPORTACIÓN DEL CLIENTE FINAL\n// ===============================\n\nexport const client = {\n  request: async (query, variables) => {\n    // Obtener token en cada request\n    const token = localStorage.getItem(\"token\");\n    const headers = token ? {\n      authorization: `Bearer ${token}`\n    } : {};\n\n    // Aplicar headers dinámicos\n    baseClient.setHeaders(headers);\n    try {\n      return await baseClient.request(query, variables);\n    } catch (err) {\n      // Mejora mensaje si hay un fallo de red\n      const msg = (err === null || err === void 0 ? void 0 : err.message) || String(err);\n      if (/Failed to fetch|NetworkError|CORS/i.test(msg)) {\n        console.warn(\"⚠️ Error de red o CORS detectado:\", err);\n      }\n      throw err;\n    }\n  },\n  // Método para headers personalizados\n  setHeaders: headers => baseClient.setHeaders(headers)\n};","map":{"version":3,"names":["GraphQLClient","endpoint","process","env","REACT_APP_API_URL","console","error","Error","createClient","url","headers","baseClient","client","request","query","variables","token","localStorage","getItem","authorization","setHeaders","err","msg","message","String","test","warn"],"sources":["C:/Users/porta/OneDrive/Documentos/Univalle/MercaDEA/Panel-Amin-Nuevo/src/api/graphqlClient.js"],"sourcesContent":["import { GraphQLClient } from \"graphql-request\";\r\n\r\n// ===============================\r\n// CONFIGURACIÓN DEL ENDPOINT\r\n// ===============================\r\n\r\n// URL desde tu archivo .env\r\n// EJEMPLO EN .env:\r\n// REACT_APP_API_URL=https://3c004bf2d4d8.ngrok-free.app/graphql\r\n\r\nconst endpoint = process.env.REACT_APP_API_URL;\r\n\r\nif (!endpoint) {\r\n  console.error(\"❌ ERROR: REACT_APP_API_URL no está definido en el archivo .env\");\r\n  throw new Error(\"REACT_APP_API_URL no configurado\");\r\n}\r\n\r\n// ===============================\r\n// CREACIÓN DEL CLIENTE BASE\r\n// ===============================\r\n\r\nfunction createClient(url) {\r\n  return new GraphQLClient(url, {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  });\r\n}\r\n\r\nconst baseClient = createClient(endpoint);\r\n\r\n// ===============================\r\n// EXPORTACIÓN DEL CLIENTE FINAL\r\n// ===============================\r\n\r\nexport const client = {\r\n  request: async (query, variables) => {\r\n    // Obtener token en cada request\r\n    const token = localStorage.getItem(\"token\");\r\n    const headers = token ? { authorization: `Bearer ${token}` } : {};\r\n\r\n    // Aplicar headers dinámicos\r\n    baseClient.setHeaders(headers);\r\n\r\n    try {\r\n      return await baseClient.request(query, variables);\r\n    } catch (err) {\r\n      // Mejora mensaje si hay un fallo de red\r\n      const msg = err?.message || String(err);\r\n      if (/Failed to fetch|NetworkError|CORS/i.test(msg)) {\r\n        console.warn(\"⚠️ Error de red o CORS detectado:\", err);\r\n      }\r\n      throw err;\r\n    }\r\n  },\r\n\r\n  // Método para headers personalizados\r\n  setHeaders: (headers) => baseClient.setHeaders(headers),\r\n};"],"mappings":"AAAA,SAASA,aAAa,QAAQ,iBAAiB;;AAE/C;AACA;AACA;;AAEA;AACA;AACA;;AAEA,MAAMC,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB;AAE9C,IAAI,CAACH,QAAQ,EAAE;EACbI,OAAO,CAACC,KAAK,CAAC,gEAAgE,CAAC;EAC/E,MAAM,IAAIC,KAAK,CAAC,kCAAkC,CAAC;AACrD;;AAEA;AACA;AACA;;AAEA,SAASC,YAAYA,CAACC,GAAG,EAAE;EACzB,OAAO,IAAIT,aAAa,CAACS,GAAG,EAAE;IAC5BC,OAAO,EAAE;MACP,cAAc,EAAE;IAClB;EACF,CAAC,CAAC;AACJ;AAEA,MAAMC,UAAU,GAAGH,YAAY,CAACP,QAAQ,CAAC;;AAEzC;AACA;AACA;;AAEA,OAAO,MAAMW,MAAM,GAAG;EACpBC,OAAO,EAAE,MAAAA,CAAOC,KAAK,EAAEC,SAAS,KAAK;IACnC;IACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMR,OAAO,GAAGM,KAAK,GAAG;MAAEG,aAAa,EAAE,UAAUH,KAAK;IAAG,CAAC,GAAG,CAAC,CAAC;;IAEjE;IACAL,UAAU,CAACS,UAAU,CAACV,OAAO,CAAC;IAE9B,IAAI;MACF,OAAO,MAAMC,UAAU,CAACE,OAAO,CAACC,KAAK,EAAEC,SAAS,CAAC;IACnD,CAAC,CAAC,OAAOM,GAAG,EAAE;MACZ;MACA,MAAMC,GAAG,GAAG,CAAAD,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,OAAO,KAAIC,MAAM,CAACH,GAAG,CAAC;MACvC,IAAI,oCAAoC,CAACI,IAAI,CAACH,GAAG,CAAC,EAAE;QAClDjB,OAAO,CAACqB,IAAI,CAAC,mCAAmC,EAAEL,GAAG,CAAC;MACxD;MACA,MAAMA,GAAG;IACX;EACF,CAAC;EAED;EACAD,UAAU,EAAGV,OAAO,IAAKC,UAAU,CAACS,UAAU,CAACV,OAAO;AACxD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}